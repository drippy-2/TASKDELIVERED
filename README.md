AutoCAD Batch DWG Processor – Documentation

Author: drippy-2
Date: 1/12/2025

1. Overview

The AutoCAD Batch DWG Processor is a PowerShell script (RealBatchProcessor.ps1) that automates the processing of multiple AutoCAD .dwg files using accoreconsole.exe and a specified AutoCAD script (.scr). It provides:

Automated batch processing

Detailed logging of each file’s processing

Timeout handling for hung processes

Verification of script output (.txt)

Cleanup of .bak files

Session summary of successes, errors, and output files

2. Requirements

Operating System: Windows 10 or higher

PowerShell: Version 5.1 or higher

AutoCAD: Installed version compatible with accoreconsole.exe

Permissions: Ability to execute scripts and manage files in the target folders

3. Installation

Place the script file (RealBatchProcessor.ps1) in a safe folder, e.g., C:\Scripts\.

Ensure your AutoCAD executable path is correct, e.g.:

C:\Program Files\Autodesk\AutoCAD 2024\accoreconsole.exe


Ensure your AutoCAD script file (.scr) is available, e.g.:

C:\Scripts\process.scr


Optionally, create a folder for .dwg files to process, e.g.:

C:\DWG_Folder

4. Usage
4.1 Running the Script

Open PowerShell and run:

.\RealBatchProcessor.ps1 -DWGFolder "C:\DWG_Folder" -ScriptFile "C:\Scripts\process.scr" -TimeoutSeconds 25


-DWGFolder: Path to the folder containing .dwg files. If omitted, a folder dialog will appear.

-ScriptFile: Path to the .scr file. Defaults to C:\Scripts\process.scr.

-TimeoutSeconds: Maximum allowed processing time per file (default 25 seconds).

4.2 Processing Flow

Folder Validation: Checks if the DWG folder exists.

Script Validation: Checks if the .scr script exists.

AutoCAD Validation: Checks if accoreconsole.exe exists.

File Iteration: Processes each .dwg file sequentially.

Backup Cleanup: Deletes previous .bak files before processing a new file.

Timeout Handling: Kills AutoCAD processes exceeding the timeout.

Output Verification: Checks for .txt files generated by the AutoCAD script.

Logging: Logs start/end times, status, duration, and .txt presence.

Session Summary: Writes total files processed, errors, .txt count, and duration to log and console.

5. Logging

Log file is created in the DWG folder or specified path (e.g., Process_Log.txt).

Each entry includes:

File name

Start and end time

Duration

Exit code

Status (SUCCESS, ERROR, EXCEPTION)

.txt output existence

Example:

Processing File: drawing1.dwg
Start: 2025-12-01 10:05:12
End: 2025-12-01 10:05:18, Duration: 6 sec
.txt exists? Yes
Exit Code: 0
Status: SUCCESS

6. Parameters
Parameter       |	 Type	|Default	|Description
-DWGFolder	    | String	|None	    |Path to folder containing DWG files. Prompts if omitted.
-ScriptFile	    |	String  |C:\Scripts\process.scr	| Path to the AutoCAD script file.
-AutoCADPath    |	String	|C:\Program Files\Autodesk\AutoCAD 2024\accoreconsole.exe	|   Path to AutoCAD console executable.
-TimeoutSeconds	|Int	    |25	 |  Maximum processing time per file (seconds).

7. Error Handling

Exit Code ≠ 0: Logged as ERROR.

Exceptions (e.g., file locked, missing AutoCAD): Logged as EXCEPTION.

Timeouts: AutoCAD process is killed, logged as ERROR.

8. Output Management

.txt files are verified for existence.

Previous .bak files are deleted to prevent clutter.

Final session summary shows:

Total files processed

Files with errors

Files with .txt output

Total duration

9. Best Practices

Keep DWG and script files in separate folders.

Adjust -TimeoutSeconds for complex drawings.

Backup important .bak files before running the batch.

Run in a user session with permissions to launch AutoCAD.

10. Troubleshooting

Issue	                |Solution
AutoCAD does not start	|Check -AutoCADPath and AutoCAD installation
Script hangs	        |Increase -TimeoutSeconds or check the DWG files
No .txt outputs	        |Verify the .scr script generates output correctly
Log file not created	|Check folder permissions

11. Future Enhancements

Parallel processing for faster batch operations.

Retry mechanism for failed files.

CSV report generation for easier data analysis.

Content verification for .txt files.